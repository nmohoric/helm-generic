{{/*
Overlay cronjob spec overlay
*/}}
{{- define "helm-generic.cronjob-spec-overlay" -}}
jobTemplate:
  spec: {}
{{- end -}}

{{/*
Generate the cronjob yaml resource
*/}}
{{- define "helm-generic.cronjob-spec" -}}
{{- $root := .root -}}
{{- $resource := deepCopy .spec -}}
{{- $_ := set $resource "spec" (mustMerge $resource.spec (include "helm-generic.cronjob-spec-overlay" $root | fromYaml)) -}}

{{- $includeRootJobSpec := dict "root" $root "spec" $resource.spec.jobTemplate -}}
{{- $jobSpec := (include "helm-generic.job-spec" $includeRootJobSpec | fromYaml) -}}
{{- $_ := set $resource.spec.jobTemplate "spec" $jobSpec -}}
{{- $spec := $resource.spec -}}

{{- tpl (toYaml $spec) $root }}
{{- end }}
