{{/*
Overlay statefulset spec overlay
*/}}
{{- define "helm-generic.statefulset-spec-overlay" -}}
replicas: 1
serviceName: {{ include "helm-generic.fullname" . }}
{{- end -}}

{{/*
Generate the statefulset yaml resource
*/}}
{{- define "helm-generic.statefulset-spec" -}}
{{- $root := .root -}}
{{- $resource := deepCopy .spec -}}
{{- $includeRoot := dict "root" $root "spec" $resource -}}
{{- $_ := set $resource "spec" (include "helm-generic.workload-spec" $includeRoot | fromYaml) -}}

{{- $_ := set $resource "spec" (mustMerge $resource.spec (include "helm-generic.statefulset-spec-overlay" $root | fromYaml)) -}}

{{- $spec := $resource.spec -}}

{{- toYaml $spec }}
{{- end }}
